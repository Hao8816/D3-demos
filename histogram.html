<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <script type="text/javascript" src="lib/d3/d3.v3.min.js"></script>
    <style type="text/css">
        .xAxis,.yAxis{
            background-color: #ddd;
        }
    </style>
</head>
<body>
<script type="text/javascript">

    // 构造数据
    var rand = d3.random.normal(0,25);
    var dataset = [];
    for (var i=0;i<100;i++){
        dataset.push(rand())
    }

    // 处理直方图数据
    var bin_num = 15;
    var histogram = d3.layout.histogram()
            .range([-50,50])
            .bins(bin_num)
            .frequency(true);
    var data = histogram(dataset);
    console.log(data)

    // 绘制图表
    var width = 1400;
    var height = 400;
    var margin = {
        top : 30,
        right : 30,
        bottom : 30,
        left : 30
    };
    var svg = d3.select('body')
            .append('svg')
            .attr('width',width+margin.left+margin.right)
            .attr('height',height+margin.top+margin.bottom)
            .append('g')
            .attr('transform',"translate("+margin.left+","+margin.top+")");

    // 创建坐标轴
//    var formatPercent = d3.format('个');

    var x = d3.scale.ordinal()
            .rangeRoundBands([0,width],0.1);
    var y = d3.scale.linear()
            .range([height,0]);

    x.domain(data.map(function(d) {
        return d.x.toFixed(1);
    }));
    y.domain([0, d3.max(data, function(d) { return d.y; })]);

    var color = d3.scale.category10();

    var xAxis = d3.svg.axis()
            .scale(x)
            .orient('bottom');

    var yAxis = d3.svg.axis()
            .scale(y)
            .orient('left')
//            .tickFormat(formatPercent);

    svg.append('g')
            .attr('class','xAxis')
            .attr('transform',"translate("+0+","+height+")")
            .call(xAxis);

    svg.append('g')
            .attr('class','yAxis')
            .call(yAxis);


    svg.selectAll(".bar")
            .data(data)
            .enter()
            .append("rect")
            .attr("class", "bar")
            .attr("x", function(d,i) { return i*100; })
            .attr("width", x.rangeBand())
            .attr("y", function(d) { return y(d.y); })
            .attr("height", function(d) { return height - y(d.y); })
            .attr("fill", function(d) { return color(d.x); });


</script>
<div id="bar_chart"></div>
</body>
</html>